\documentclass[11pt,]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={},
            pdftitle={},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{0}

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{}
  \pretitle{\vspace{\droptitle}}
  \posttitle{}
  \author{}
  \preauthor{}\postauthor{}
  \date{}
  \predate{}\postdate{}

% load packages
\usepackage{amsmath,amsfonts,float,makecell,titletoc,titlesec,tocloft,titling,natbib,pdfpages,lineno,booktabs}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[doublespacing]{setspace}

% format captions
\usepackage[labelfont={small,bf}, labelsep=space, font={small}]{caption}

% format toc
%\renewcommand\cftsubsecfont{\normalfont\normalsize\bfseries}
% \renewcommand\cftsubsubsecfont{\normalfont\normalsize\bfseries}
% \renewcommand\cftparafont{\normalfont\normalsize\bfseries}
% \renewcommand\cftsubparafont{\normalfont\normalsize\itshape}

% line numbers
\linenumbers

% format abstract
\renewcommand{\abstractname}{Summary}
\renewenvironment{abstract}
 {\small
  \begin{center}
  \bfseries \abstractname\vspace{-.5em}\vspace{0pt}
  \end{center}
  \list{} {%
   \setlength{\leftmargin}{2mm}
   \setlength{\rightmargin}{\leftmargin}%
  }%
  \item\relax}
{\endlist}

% format section headers
\titleformat*{\section}{\Large\bfseries}
\titleformat{\subsection}[display]
	{\large\sffamily\lsstyle}
	{\subsectiontitlename\ \thesubsection}
	{0.5em}{}
\titleformat*{\subsubsection}{\large\itshape}

% make figures static
\let\origfigure\figure
\let\endorigfigure\endfigure
\renewenvironment{figure}[1][2] {
	\expandafter\origfigure\expandafter[H]
} {
	\endorigfigure
}

% define struts for tables
\newcommand\T{\rule{0pt}{2.6ex}} % top strut
\newcommand\B{\rule[-1.2ex]{0pt}{0pt}} % bottom strut

% define command to put new lines in table cells
%\newcommand{\specialcell}[2][c]{%
%  \begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}
% insert S before figure and table caption
\pagenumbering{gobble}
\renewcommand{\thefigure}{S\arabic{figure}}
\renewcommand{\thetable}{S\arabic{table}}


\begin{document}

\maketitle


\section{Supporting Information}\label{supporting-information}

\subsection{Reliable formulation}\label{reliable-formulation}

The reliable formulation explicitly considers the probability that the
planning units are inhabited. As a consequence, it may deliver
prioritisations that will sufficiently represent an attribute space even
if the features do not inhabit several of the planning units when the
prioritisation is implemented. This behaviour is achieved by siting
back-up planning units near selected planning units with low occupancy
probabilities in the attribute space(s). To ensure that prioritisations
are robust against multiple planning units being uninhabited, the
problem assigns planning units at multiple backup levels.

Backup levels levels are defined as $r$-levels (similar to failure
levels in Snyder \& Daskin 2005). The first backup $r$-level is used to
calculate the level of representation when all of the selected planning
units are occupied by all $f \in F$. For this scenario, the closest
selected planning unit to each demand point $i$ for attribute space $s$
is assigned at $r$-level$=0$. This scenario essentially represents
$Y_{fsij}$ in the unreliable formulation. The second backup $r$-level is
used to assess the level of representation when the closest planning
unit to each demand point $i$ is unoccupied. For this scenario, the
second closest planning units are assigned at $r$-level$=1$. The third
backup $r$-level is used to assess representation when the first two
closest planning units are unoccupied. The third closest planning units
are assigned at $r$-level$=2$. Continuing on, in this manner, the
selected planning units in a prioritisation are assigned to each demand
point $i \in I$, attribute space $s \in S$, and each feature $f \in F$
at an $r$-level.

A final backup $r$-level when $r=R$ is used to assess the level of
representation when the features $f \in F$ do not occupy any selected
planning units in a prioritisation. Each demand point $i \in I$ for each
$s \in S$ and $f \in F$ is assigned to an ``imaginary'' planning unit
$j=J$ at $r=R$. The distance variables associated with this imaginary
planning unit $d_{fsiJ}$ denote the loss of biological value associated
with failing to secure a representative sample of feature $f$ in
attribute space $s$. However, the $d$ variables are in distance units
which are meaningless in this context. Thus these variables are
calculated using a failure multiplier ($M$) and the maximum distance
between the planning units and the demand points for $f \in F$,
$s \in S$ (4).

\begin{align*}
& d_{fsiJ} = M \max\limits_{0 \leq i \leq I-1, 0 \leq j \leq J-1} d_{fsij} & \forall & 0 \leq f \leq F-1, \tag*{eqn 4} \\
& & & 0 \leq s \leq S-1\\
\end{align*}

Moderately-sized conservation planning problems often include several
thousand planning units. It is currently not be feasible to solve this
problem when considering all possible failure scenarios. As a
consequence, the $R$ variable can be any $1 \leq R \leq J-1$. For
instance, when $R=3$ only 2 backup levels are considered in addition to
the final backup level. Cui et al. (2010) found that $R=5$ yields
similar solutions to $R=J$ when $J >> 5$. However, in most costs the
decision maker will likely be limited to $R=1$ to obtain prioritisations
in a feasible amount of time.

The control variables for the reliable formulation are the $B$ (eqn 1a),
$T_{s}$ (eqn 1b), $\tau_{sa}$ (eqn 1c), $R$, and $M$ variables.

\begin{align*}
R &= \parbox{25em}{number of failure levels} \tag*{eqn 5a} \\
%
M &= \parbox{25em}{failure multiplier} \tag*{eqn 5b}\\
%
\end{align*}

The decision variables are the $X_j$ (eqn 2a), $Y_{fsijr}$, $P_{fsijr}$
variables.

\begin{align*}
Y_{fsijr} &= \begin{cases}
        1, & \parbox{25em}{if demand point $i$ is assigned to planning unit $j$ for feature $f$ in space $s$ at back-up level $r$. } \tag*{eqn 6a} \\
        0, & \parbox{25em}{otherwise} \\
    \end{cases} \\
%
P_{fsijr} &= \parbox{25em}{probability that demand point $i$ is assigned to planning unit $j$ at back-up level $r$ for feature $f$ and space $s$} \tag*{eqn 6a}\\
%
\end{align*}

The reliable formulation (RRAP) is a multi-objective optimisation
problem.

\begin{align*}
& \text{(RRAP)} & \text{Min } & \text{(3a)}\\
%
& & \text{s.t. } & \text{(3b)}\\
%
& & & 1 - \frac{\sum_{i=0}^{I-1} \sum_{j=0}^{J-1} \lambda_{fsi} {d_{fsij}}^{2} P_{fsijr} Y_{fsij}}{\sum_{i=0}^{I-1} \lambda_{fsi} {\delta_{fsi}}^{2}} \geq T_{fs}  & \forall & 0 \leq f \leq F-1, \tag*{eqn 7a}\\
& & & & & 0 \leq s \leq S-1\\
%
& & & \sum_{j=0}^{J-1} Y_{fsijr} = 1 & \forall & 0 \leq f \leq F-1, \tag*{eqn 7b}\\
& & & & & 0 \leq s \leq S-1,\\
& & & & & 0 \leq i \leq I-1,\\
& & & & & 0 \leq r \leq R\\
%
& & & \sum_{r=0}^{R} Y_{fsijr} = 1 & \forall & 0 \leq f \leq F-1, \tag*{eqn 7c}\\
& & & & & 0 \leq s \leq S-1,\\
& & & & & 0 \leq i \leq I-1,\\
& & & & & 0 \leq j \leq J\\
%
& & & \sum_{r=0}^{R-1} Y_{fsijr} \leq X_j & \forall & 0 \leq f \leq F-1, \tag*{eqn 7d}\\
& & & & & 0 \leq s \leq S-1,\\
& & & & & 0 \leq i \leq I-1,\\
& & & & & 0 \leq j \leq J-1\\
%
& & & Y_{fsiJR} = 1 & \forall & 0 \leq f \leq F-1, \tag*{eqn 7e}\\
& & & & & 0 \leq s \leq S-1,\\
& & & & & 0 \leq i \leq I-1\\
%
& & & P_{fsij0} = q_{fj} & \forall & 0 \leq f \leq F-1, \tag*{eqn 7f}\\
& & & & & 0 \leq s \leq S-1,\\
& & & & & 0 \leq i \leq I-1,\\
& & & & & 0 \leq j \leq J\\
%
& & & P_{fsijr} = \left(1 - \right) \sum_{k=0}^{J-1} \frac{1 - q_k}{q_k} P_{f,s,i,k,r-1} Y_{f,s,i,k,r-1}  & \forall & 0 \leq f \leq F-1, \tag*{eqn 7g}\\
& & & & & 0 \leq s \leq S-1,\\
& & & & & 0 \leq i \leq I-1,\\
& & & & & 0 \leq j \leq J,\\
& & & & & 1 \leq r \leq R\\
%
& & & X_j, Y_{fsijr} \in {0,1} & \forall & 0 \leq f \leq F-1, \tag*{eqn 7h}\\
& & & & & 0 \leq s \leq S-1,\\
& & & & & 0 \leq i \leq I-1,\\
& & & & & 0 \leq j \leq J,\\
& & & & & 0 \leq r \leq R\\
\end{align*}

The objective function for the reliable formulation is the same as for
the unreliable formation (eqn 3a). Similar to the unreliable
formulation, constraints (eqn 3b) and (eqn 7a) ensure that the
amount-based and space-based targets are met. Constraint (eqns 7b--7c)
ensure that each planning unit is only assigned to one backup $r$-level
for $i \in I$. Constraints (eqn 7d) ensure that only selected planning
units are assigned to demand points $i \in I$. Constraints (eqn 7e)
ensure that the imaginary planning unit is always assigned to the
highest backup $r$-level. Constraints (eqns 7f--7g) determine the
probability that planning unit $j$ will be used to sample demand point
$i \in I$ for $s \in S$ and $f \in F$ (see Cui \emph{et al.} 2010 for
more information). Constraints (eqn 7h) ensure that the $X$ and $Y$
variables are binary.

The reliable formulation is non-linear. However, the non-linear
components can be linearised. First--as discussed in the main text--the
expression $X_j X_k$ in (eqn 3a) can be linearised using methods
described by Beyer et al. (2016). Second, the expression
$P_{fsijr} Y_{jsijr}$ in (eqn 7a) can be linearised using techniques
described by Sherali and Alameddine (1992) as implemented in Cui et al.
(2010).

\subsection{Figures}\label{figures}

\begin{figure}[htbp]
\centering
\includegraphics{supporting-information_files/figure-latex/unnamed-chunk-3-1.pdf}
\caption{Attribute spaces used in the first case-study. Each panel shows
a the distribution of a solution in environmental space and how it
samples the realised niche for a different species. The left column of
panels shows the solution generated using amount targets. The right
column of panels shows the solution generated using amount and niche
targets. Each column of panels corresponds to a different species.
Hexagons show the distribution of demand points. The color of each
heaxgon denotes the weighted frequency of demand points inside it.
Points represent the environmental conditions associated with planning
units inside the species geographic range that were selected for
preservation in a given solution.}
\end{figure}

\subsection{Tables}\label{tables}

\begin{table}[H]
\caption{Symbols and descriptions of terms used in the formulation of the unreliable representative and adequate prioritisation (URAP) problem.\label{term.DF}} 
\begin{center}
\begin{tabular}{cl}
\toprule[1pt]
\multicolumn{1}{c}{Symbol}&\multicolumn{1}{c}{Description}\tabularnewline
\midrule
$F$&\parbox[t][][t]{15cm}{set of biodiversity features (indexed by $f$)}\tabularnewline
$J$&\parbox[t][][t]{15cm}{set of planning units (indexed by $j$)}\tabularnewline
$q_{fj}$&\parbox[t][][t]{15cm}{probability of feature $f$ occupying planning unit $j$}\tabularnewline
$e_{jk}$&\parbox[t][][t]{15cm}{shared edge between planning unit $j$ and planning unit $k$. Note that when $j==k$ this used to parametrise exposed edges with no neighbours.}\tabularnewline
$S$&\parbox[t][][t]{15cm}{set of attribute spaces (indexed by $S$)}\tabularnewline
$I_{fsi}$&\parbox[t][][t]{15cm}{set of demand points (indexed by $i$) for a feature $f$ in attribute space $s$}\tabularnewline
$\lambda_{fsi}$&\parbox[t][][t]{15cm}{set of weights for demand point $i$ for feature $f$ in attribute space $s$.}\tabularnewline
$d_{fsij}$&\parbox[t][][t]{15cm}{distance between demand point $i$ and planning unit $j$ for feature $f$ in attribute space $s$.}\tabularnewline
$\delta_{fsi}$&\parbox[t][][t]{15cm}{the distance between each demand point $i$ and the centroid of the demand points $I$ for feature $f$ in attribute space $s$.}\tabularnewline
$T_f$&\parbox[t][][t]{15cm}{amount target for feature $f$.}\tabularnewline
$\tau_{fs}$&\parbox[t][][t]{15cm}{space-based target for feature $f$ in attribute space $s$.}\tabularnewline
$X_j$&\parbox[t][][t]{15cm}{binary decision variable controlling if a planning unit is selected for preservation (1) or discarded (0).}\tabularnewline
$Y_{fsij}$&\parbox[t][][t]{15cm}{binary decision variable indicating if planning unit $j$ is assigned to demand point $i$ for species $s$ in a attribute space $s$ when determing the amount of the attribute space sampled by the selected planning units.}\tabularnewline
\bottomrule[1pt]
\end{tabular}\end{center}

\end{table}

\section{References}\label{references}

Beyer, H.L., Dujardin, Y., Watts, M.E. \& Possingham, H.P. (2016).
Solving conservation planning problems with integer linear programming.
\emph{Ecological Modelling}, \textbf{328}, 14--22.

Cui, T.T., Ouyang, Y.F. \& Shen, Z.J.M. (2010). Reliable facility
location design under the risk of disruptions. \emph{Operations
Research}, \textbf{58}, 998--1011.

Sherali, H. \& Alameddine, A. (1992). A new reformulation-linearization
technique for bilinear programming problems. \emph{Journal of Global
Optimization}, \textbf{2}, 379--410.

Snyder, L.V. \& Daskin, M.S. (2005). Reliability models for facility
location: the expected failure cost case. \emph{Transportation Science},
\textbf{39}, 400--416.

\end{document}
